package main

import "golang.org/x/net/bpf"

var (
	// tcpdump -s 100 -dd "inbound and ip6 and ((icmp6 and ip6[40] == 135) or tcp)"
	filterTcpNdp = []bpf.RawInstruction{
		{ 0x28, 0, 0, 0xfffff004 },
		{ 0x15, 15, 0, 0x00000004 },
		{ 0x28, 0, 0, 0x0000000c },
		{ 0x15, 0, 13, 0x000086dd },
		{ 0x30, 0, 0, 0x00000014 },
		{ 0x15, 3, 0, 0x0000003a },
		{ 0x15, 0, 4, 0x0000002c },
		{ 0x30, 0, 0, 0x00000036 },
		{ 0x15, 0, 5, 0x0000003a },
		{ 0x30, 0, 0, 0x00000036 },
		{ 0x15, 5, 0, 0x00000087 },
		{ 0x30, 0, 0, 0x00000014 },
		{ 0x15, 3, 0, 0x00000006 },
		{ 0x15, 0, 3, 0x0000002c },
		{ 0x30, 0, 0, 0x00000036 },
		{ 0x15, 0, 1, 0x00000006 },
		{ 0x6, 0, 0, 0x00000064 },
		{ 0x6, 0, 0, 0x00000000 },
	}

	// tcpdump -s 100 -dd "inbound and ip6 and tcp"
	filterTcp = []bpf.RawInstruction{
		{ 0x28, 0, 0, 0xfffff004 },
		{ 0x15, 8, 0, 0x00000004 },
		{ 0x28, 0, 0, 0x0000000c },
		{ 0x15, 0, 6, 0x000086dd },
		{ 0x30, 0, 0, 0x00000014 },
		{ 0x15, 3, 0, 0x00000006 },
		{ 0x15, 0, 3, 0x0000002c },
		{ 0x30, 0, 0, 0x00000036 },
		{ 0x15, 0, 1, 0x00000006 },
		{ 0x6, 0, 0, 0x00000064 },
		{ 0x6, 0, 0, 0x00000000 },
	}

	// tcpdump -s 100 -dd "inbound and ip6 and ((icmp6 and ip6[40] == 135) or udp)"
	filterUdpNdp = []bpf.RawInstruction{
		{ 0x28, 0, 0, 0xfffff004 },
		{ 0x15, 15, 0, 0x00000004 },
		{ 0x28, 0, 0, 0x0000000c },
		{ 0x15, 0, 13, 0x000086dd },
		{ 0x30, 0, 0, 0x00000014 },
		{ 0x15, 3, 0, 0x0000003a },
		{ 0x15, 0, 4, 0x0000002c },
		{ 0x30, 0, 0, 0x00000036 },
		{ 0x15, 0, 5, 0x0000003a },
		{ 0x30, 0, 0, 0x00000036 },
		{ 0x15, 5, 0, 0x00000087 },
		{ 0x30, 0, 0, 0x00000014 },
		{ 0x15, 3, 0, 0x00000011 },
		{ 0x15, 0, 3, 0x0000002c },
		{ 0x30, 0, 0, 0x00000036 },
		{ 0x15, 0, 1, 0x00000011 },
		{ 0x6, 0, 0, 0x00000064 },
		{ 0x6, 0, 0, 0x00000000 },
	}

	// tcpdump -s 100 -dd "inbound and ip6 and udp"
	filterUdp = []bpf.RawInstruction{
		{ 0x28, 0, 0, 0xfffff004 },
		{ 0x15, 8, 0, 0x00000004 },
		{ 0x28, 0, 0, 0x0000000c },
		{ 0x15, 0, 6, 0x000086dd },
		{ 0x30, 0, 0, 0x00000014 },
		{ 0x15, 3, 0, 0x00000011 },
		{ 0x15, 0, 3, 0x0000002c },
		{ 0x30, 0, 0, 0x00000036 },
		{ 0x15, 0, 1, 0x00000011 },
		{ 0x6, 0, 0, 0x00000064 },
		{ 0x6, 0, 0, 0x00000000 },
	}
)